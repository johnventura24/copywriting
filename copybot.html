<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Copywriting Bot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f9f9f9;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 36px;
            color: #2563eb;
            margin-bottom: 10px;
        }

        header p {
            font-size: 18px;
            color: #666;
        }

        /* Password Protection Styles */
        .password-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .password-modal {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .password-modal h2 {
            color: #2563eb;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .password-modal p {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
        }

        .password-input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .unlock-btn {
            background-color: #2563eb;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.2s;
        }

        .unlock-btn:hover {
            background-color: #1d4ed8;
        }

        .unlock-btn:disabled {
            background-color: #93c5fd;
            cursor: not-allowed;
        }

        .error-message {
            color: #dc2626;
            margin-top: 15px;
            font-size: 14px;
        }

        .main-content {
            display: none;
        }

        .main-content.unlocked {
            display: block;
        }

        .app-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .settings-panel {
            background-color: #f1f5f9;
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .api-key-container {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .api-key-container input {
            flex: 1;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 15px;
        }

        .api-key-container small {
            margin-left: 10px;
            color: #64748b;
            font-size: 13px;
        }

        .options-row {
            display: flex;
            gap: 15px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .option-group {
            flex: 1;
            min-width: 180px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #475569;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background-color: white;
            font-size: 15px;
        }

        .content-area {
            display: flex;
            padding: 25px;
            gap: 25px;
        }

        .input-column, .output-column {
            flex: 1;
        }

        h2 {
            font-size: 18px;
            color: #334155;
            margin-bottom: 16px;
        }

        textarea {
            width: 100%;
            height: 300px;
            padding: 16px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            resize: none;
            font-size: 15px;
            margin-bottom: 16px;
        }

        button {
            background-color: #2563eb;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #1d4ed8;
        }

        button:disabled {
            background-color: #93c5fd;
            cursor: not-allowed;
        }

        button.copy-all {
            background-color: transparent;
            border: 1px solid #2563eb;
            color: #2563eb;
        }

        button.copy-all:hover {
            background-color: #eff6ff;
        }

        .output-container {
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 16px;
            background-color: #f8fafc;
            height: 300px;
            overflow-y: auto;
        }

        .variation {
            background-color: white;
            border-left: 3px solid #2563eb;
            padding: 12px;
            margin-bottom: 12px;
            border-radius: 4px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }

        .variation:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .variation.selected-winner {
            border-left-color: #10b981;
            background-color: #f0fdf4;
        }

        .variation-number {
            font-weight: 600;
            color: #2563eb;
            margin-bottom: 8px;
        }

        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: transparent;
            color: #2563eb;
            border: 1px solid #2563eb;
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 4px;
        }

        .copy-button:hover {
            background-color: #eff6ff;
        }

        .loader {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .loader div {
            width: 20px;
            height: 20px;
            background-color: #2563eb;
            border-radius: 50%;
            display: inline-block;
            margin: 0 5px;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loader div:nth-child(1) {
            animation-delay: -0.32s;
        }

        .loader div:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }

        .output-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .regenerate {
            background-color: transparent;
            border: 1px solid #2563eb;
            color: #2563eb;
        }

        .regenerate:hover {
            background-color: #eff6ff;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            color: #64748b;
            font-size: 14px;
        }

        footer a {
            color: #2563eb;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Slider Styles */
        .slider-container {
            position: relative;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
            margin-bottom: 25px;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2563eb;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2563eb;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .slider-labels {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
        }

        .slider-labels span {
            font-size: 12px;
            color: #666;
        }

        #aggressiveness-value {
            font-weight: 600;
            color: #2563eb;
        }

        /* Research Data Styles */
        .research-data-group {
            flex: 2;
        }

        .research-data-group textarea {
            height: 80px;
            resize: vertical;
            font-size: 14px;
        }

        .status-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background-color: #dcfce7;
            color: #166534;
            margin-bottom: 15px;
        }

        /* History Panel Styles */
        .history-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #2563eb;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
            transition: all 0.2s;
        }

        .history-toggle:hover {
            background-color: #1d4ed8;
            transform: translateY(-2px);
        }

        .history-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background-color: white;
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 200;
            overflow-y: auto;
        }

        .history-panel.open {
            right: 0;
        }

        .history-header {
            padding: 20px;
            background-color: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .history-header h3 {
            margin: 0 0 10px 0;
            color: #1e293b;
            font-size: 18px;
        }

        .history-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .history-controls button {
            flex: 1;
            padding: 8px 12px;
            font-size: 12px;
            border-radius: 4px;
        }

        .filter-btn {
            background-color: transparent;
            border: 1px solid #e2e8f0;
            color: #64748b;
        }

        .filter-btn.active {
            background-color: #2563eb;
            border-color: #2563eb;
            color: white;
        }

        .clear-history-btn {
            background-color: #dc2626;
            border: 1px solid #dc2626;
            color: white;
        }

        .history-content {
            padding: 20px;
        }

        .history-item {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #e2e8f0;
        }

        .history-item.winner {
            border-left-color: #10b981;
            background-color: #f0fdf4;
        }

        .history-item.loser {
            border-left-color: #ef4444;
            background-color: #fef2f2;
        }

        .history-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 12px;
            color: #64748b;
        }

        .history-settings {
            font-size: 11px;
            background-color: #e2e8f0;
            padding: 4px 8px;
            border-radius: 12px;
            margin-bottom: 8px;
        }

        .history-original {
            font-weight: 600;
            margin-bottom: 8px;
            color: #1e293b;
            font-size: 13px;
        }

        .history-variations {
            margin-bottom: 10px;
        }

        .history-variation {
            background-color: white;
            padding: 8px;
            margin: 4px 0;
            border-radius: 4px;
            font-size: 12px;
            border: 1px solid #e2e8f0;
            position: relative;
        }

        .history-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .tag-btn {
            padding: 4px 12px;
            font-size: 11px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }

        .tag-winner {
            background-color: #10b981;
            color: white;
        }

        .tag-loser {
            background-color: #ef4444;
            color: white;
        }

        .tag-neutral {
            background-color: #6b7280;
            color: white;
        }

        .copy-history-btn {
            background-color: transparent;
            border: 1px solid #2563eb;
            color: #2563eb;
            padding: 4px 8px;
            font-size: 11px;
        }

        .close-history {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #64748b;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .history-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .stat-item {
            text-align: center;
            flex: 1;
        }

        .stat-number {
            font-size: 18px;
            font-weight: 600;
            color: #1e293b;
        }

        .stat-label {
            font-size: 11px;
            color: #64748b;
            text-transform: uppercase;
        }

        .no-history {
            text-align: center;
            color: #64748b;
            font-style: italic;
            margin-top: 50px;
        }

        .download-history-btn {
            background-color: #059669;
            border: 1px solid #059669;
            color: white;
        }

        .winner-badge {
            position: absolute;
            top: 5px;
            left: 5px;
            background-color: #10b981;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .select-winner-btn {
            background-color: #10b981;
            color: white;
            padding: 8px 16px;
            margin-top: 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
        }

        .select-winner-btn:hover {
            background-color: #059669;
        }

        .select-winner-btn:disabled {
            background-color: #86efac;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- Password Protection Overlay -->
    <div class="password-overlay" id="password-overlay">
        <div class="password-modal">
            <h2>🔒 Access Required</h2>
            <p>Enter the password to access the AI Copywriting Bot</p>
            <input type="password" class="password-input" id="password-input" placeholder="Enter password">
            <button class="unlock-btn" id="unlock-btn">Unlock Bot</button>
            <div class="error-message" id="error-message"></div>
        </div>
    </div>

    <!-- Main Content (Hidden until unlocked) -->
    <div class="main-content" id="main-content">
        <!-- History Toggle Button -->
        <button class="history-toggle" id="history-toggle">📝 History</button>

        <!-- History Panel -->
        <div class="history-panel" id="history-panel">
            <div class="history-header">
                <button class="close-history" id="close-history">×</button>
                <h3>Copy History</h3>
                <div class="history-stats">
                    <div class="stat-item">
                        <div class="stat-number" id="total-sessions">0</div>
                        <div class="stat-label">Sessions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-winners">0</div>
                        <div class="stat-label">Winners</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-losers">0</div>
                        <div class="stat-label">Losers</div>
                    </div>
                </div>
                <div class="history-controls">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="winners">Winners</button>
                    <button class="filter-btn" data-filter="losers">Losers</button>
                    <button class="clear-history-btn" id="clear-history">Clear</button>
                    <button class="download-history-btn" id="download-history">Download Excel</button>
                </div>
            </div>
            <div class="history-content" id="history-content">
                <div class="no-history">No copy history yet. Generate some variations to get started!</div>
            </div>
        </div>

        <div class="container">
            <header>
                <h1>AI Copywriting Bot</h1>
                <p>Generate creative variations of your marketing copy in seconds</p>
                <div class="status-indicator">✅ API Key Configured</div>
            </header>

            <div class="app-container">
                <div class="settings-panel">
                    <div class="options-row">
                        <div class="option-group">
                            <label for="copy-format">Copy Format:</label>
                            <select id="copy-format">
                                <option value="">Not Applicable</option>
                                <option value="ad-script">Ad Script</option>
                                <option value="video-hook">Video Hook</option>
                                <option value="ad-copy-headline">Ad Copy Headline</option>
                                <option value="ad-copy-text">Ad Copy Ad Text</option>
                                <option value="lander-headline">Lander Headline</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label for="platform">Platform:</label>
                            <select id="platform">
                                <option value="">Not Applicable</option>
                                <option value="google">Google Ads</option>
                                <option value="facebook">Facebook Ads</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label for="lead-type">Lead Type:</label>
                            <select id="lead-type">
                                <option value="">Not Applicable</option>
                                <option value="story">Story Lead</option>
                                <option value="proclamation">Proclamation Lead</option>
                                <option value="secret">Secret Lead</option>
                                <option value="problem-solution">Problem-Solution Lead</option>
                                <option value="promise">Promise Lead</option>
                                <option value="offer">Offer Lead</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label for="angles">Angles:</label>
                            <select id="angles">
                                <option value="">Not Applicable</option>
                                <option value="otc-cards">Medicare - OTC Cards / OTC Benefits</option>
                                <option value="flex-cards">Medicare - Flex Cards / Flexible Benefits</option>
                                <option value="cashback">Medicare - Cashback / Part B Giveback</option>
                                <option value="dental">Medicare - Dental</option>
                                <option value="vision">Medicare - Vision</option>
                                <option value="hearing">Medicare - Hearing</option>
                                <option value="groceries">Medicare - Groceries</option>
                                <option value="gas-money">Medicare - Gas Money</option>
                                <option value="savings">Medicare - Savings</option>
                                <option value="auto-insurance">Auto - Insurance</option>
                                <option value="auto-coverage">Auto - Coverage</option>
                                <option value="auto-rates">Auto - Rates</option>
                                <option value="final-expense-burial">Final Expense - Burial Insurance</option>
                                <option value="final-expense-life">Final Expense - Life Insurance</option>
                                <option value="final-expense-coverage">Final Expense - Coverage</option>
                                <option value="dollar-50">Dollar Amount - $50</option>
                                <option value="dollar-100">Dollar Amount - $100</option>
                                <option value="dollar-150">Dollar Amount - $150</option>
                                <option value="dollar-200">Dollar Amount - $200</option>
                                <option value="dollar-250">Dollar Amount - $250</option>
                                <option value="dollar-300">Dollar Amount - $300</option>
                                <option value="dollar-400">Dollar Amount - $400</option>
                                <option value="dollar-500">Dollar Amount - $500</option>
                                <option value="dollar-1000">Dollar Amount - $1,000</option>
                                <option value="dollar-1500">Dollar Amount - $1,500</option>
                                <option value="dollar-2000">Dollar Amount - $2,000</option>
                            </select>
                        </div>
                    </div>

                    <div class="options-row">
                        <div class="option-group">
                            <label for="copywriting-style">Copywriting Style:</label>
                            <select id="copywriting-style">
                                <option value="">Not Applicable</option>
                                <option value="direct-response">Direct Response</option>
                                <option value="emotional">Emotional</option>
                                <option value="conversational">Conversational</option>
                                <option value="authoritative">Authoritative</option>
                                <option value="urgency">Urgency & Scarcity</option>
                                <option value="benefit-focused">Benefit-Focused</option>
                                <option value="storytelling">Storytelling</option>
                                <option value="social-proof">Social Proof</option>
                                <option value="curiosity">Curiosity-Driven</option>
                                <option value="fear-based">Fear-Based</option>
                                <option value="aspirational">Aspirational</option>
                                <option value="educational">Educational</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label for="famous-copywriter">Famous Copywriter:</label>
                            <select id="famous-copywriter">
                                <option value="">Not Applicable</option>
                                <option value="david-ogilvy">David Ogilvy - Research-based, sophisticated</option>
                                <option value="bill-bernbach">Bill Bernbach - Creative, witty, unexpected</option>
                                <option value="leo-burnett">Leo Burnett - Warm, human, down-to-earth</option>
                                <option value="rosser-reeves">Rosser Reeves - Hard-hitting USP focus</option>
                                <option value="claude-hopkins">Claude Hopkins - Scientific, tested approach</option>
                                <option value="john-caples">John Caples - Curiosity-driven headlines</option>
                                <option value="eugene-schwartz">Eugene Schwartz - Psychological sophistication</option>
                                <option value="gary-halbert">Gary Halbert - Conversational, storytelling</option>
                                <option value="dan-kennedy">Dan Kennedy - Bold, no-nonsense direct response</option>
                                <option value="joe-sugarman">Joe Sugarman - Psychological triggers, smooth flow</option>
                                <option value="victor-schwab">Victor Schwab - Systematic, attention-getting</option>
                                <option value="robert-collier">Robert Collier - Personal, letter-like approach</option>
                                <option value="maxwell-sackheim">Maxwell Sackheim - Intellectual appeal, curiosity</option>
                                <option value="john-e-kennedy">John E. Kennedy - Reason-why, logical proof</option>
                                <option value="albert-lasker">Albert Lasker - Dramatic, emotional appeals</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label for="emotional-trigger">Emotional Trigger:</label>
                            <select id="emotional-trigger">
                                <option value="">Not Applicable</option>
                                <option value="fear-of-missing-out">Fear of Missing Out (FOMO)</option>
                                <option value="security-safety">Security & Safety</option>
                                <option value="pride-status">Pride & Status</option>
                                <option value="love-belonging">Love & Belonging</option>
                                <option value="anger-frustration">Anger & Frustration</option>
                                <option value="hope-optimism">Hope & Optimism</option>
                                <option value="guilt-shame">Guilt & Shame</option>
                                <option value="excitement-joy">Excitement & Joy</option>
                                <option value="trust-credibility">Trust & Credibility</option>
                                <option value="curiosity-intrigue">Curiosity & Intrigue</option>
                                <option value="urgency-scarcity">Urgency & Scarcity</option>
                                <option value="empowerment-control">Empowerment & Control</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label for="num-variations">Number of Variations:</label>
                            <select id="num-variations">
                                <option value="3">3 Variations</option>
                                <option value="5" selected>5 Variations</option>
                                <option value="10">10 Variations</option>
                            </select>
                        </div>
                    </div>

                    <div class="options-row">
                        <div class="option-group">
                            <label for="aggressiveness">Aggressiveness Level:</label>
                            <div class="slider-container">
                                <input type="range" id="aggressiveness" min="1" max="10" value="5" class="slider">
                                <div class="slider-labels">
                                    <span>Subtle (1)</span>
                                    <span id="aggressiveness-value">5</span>
                                    <span>Aggressive (10)</span>
                                </div>
                            </div>
                        </div>
                        <div class="option-group research-data-group">
                            <label for="research-data">Research Data (Optional):</label>
                            <textarea id="research-data" placeholder="Enter statistics, studies, facts, or data points to include in the copy variations...

Examples:
• 87% of Medicare beneficiaries save $1,200+ annually
• Study shows 9 out of 10 customers satisfied
• Over 2 million members nationwide
• Average savings of $150/month on prescriptions" rows="3"></textarea>
                        </div>
                    </div>
                </div>

                <div class="content-area">
                    <div class="input-column">
                        <h2>Original Copy</h2>
                        <textarea id="original-copy" placeholder="Enter your original marketing copy here..."></textarea>
                        <button id="generate-btn">Generate Variations</button>
                    </div>
                    <div class="output-column">
                        <div class="output-controls">
                            <h2>Generated Variations</h2>
                            <button class="copy-all" id="copy-all-btn">Copy All</button>
                        </div>
                        <div class="output-container" id="output-container">
                            <div class="loader" id="loader">
                                <div></div>
                                <div></div>
                                <div></div>
                            </div>
                            <!-- Variations will appear here -->
                        </div>
                        <button class="select-winner-btn" id="select-winner-btn" style="display: none;">Select Winner</button>
                        <button class="regenerate" id="regenerate-btn" style="display: none; margin-top: 16px;">Regenerate</button>
                    </div>
                </div>
            </div>

            <footer>
                <p>Powered by OpenAI's API • <a href="#" id="logout-btn">Logout</a></p>
            </footer>
        </div>
    </div>

    <script>
        // Encrypted API key - replace this with your actual encrypted API key
        const ENCRYPTED_API_KEY = "U2FsdGVkX198oxL0eEth0AcoJelQz/mxtw8BGtnFWUwxixHy2sNpHex8LxIxsSW9Jir1aBxxrk1mhGec68nuHzkk6tisfvVkaob9EqDILkqsLB0SRtIds4vn9Uodx3PPj7zyjdu4hLDzNwJI021O6zQM2dmC0icieqmDvYcW757mTbpruJYS1sYy9CnCfGw8aiRK9MwdBguowRzoMHLJc8A7cvCEtG+fGsuv61kAQdjVqcunGrioVAlANaVFoALF";
        const CORRECT_PASSWORD = "100%roi";
        
        let decryptedApiKey = null;
        
        // History management
        let copyHistory = JSON.parse(localStorage.getItem('copyHistory') || '[]');
        let currentFilter = 'all';
        let selectedVariationIndex = null;
        let currentVariations = [];
        let currentSettings = {};
        
        // Password protection functionality
        document.addEventListener('DOMContentLoaded', () => {
            const passwordOverlay = document.getElementById('password-overlay');
            const mainContent = document.getElementById('main-content');
            const passwordInput = document.getElementById('password-input');
            const unlockBtn = document.getElementById('unlock-btn');
            const errorMessage = document.getElementById('error-message');
            const logoutBtn = document.getElementById('logout-btn');
            
            // Check if already authenticated in this session
            if (sessionStorage.getItem('authenticated') === 'true') {
                unlockApp();
            }
            
            // Handle password submission
            unlockBtn.addEventListener('click', handlePasswordSubmit);
            passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handlePasswordSubmit();
                }
            });
            
            // Handle logout
            logoutBtn.addEventListener('click', () => {
                sessionStorage.removeItem('authenticated');
                decryptedApiKey = null;
                passwordOverlay.style.display = 'flex';
                mainContent.classList.remove('unlocked');
                passwordInput.value = '';
                errorMessage.textContent = '';
            });
            
            function handlePasswordSubmit() {
                const enteredPassword = passwordInput.value.trim();
                
                if (enteredPassword === CORRECT_PASSWORD) {
                    try {
                        // Decrypt the API key
                        const bytes = CryptoJS.AES.decrypt(ENCRYPTED_API_KEY, CORRECT_PASSWORD);
                        decryptedApiKey = bytes.toString(CryptoJS.enc.Utf8);
                        
                        if (decryptedApiKey && decryptedApiKey.startsWith('sk-')) {
                            sessionStorage.setItem('authenticated', 'true');
                            unlockApp();
                        } else {
                            throw new Error('Invalid decryption result');
                        }
                    } catch (error) {
                        console.error('Decryption error:', error);
                        errorMessage.textContent = 'Error decrypting API key. Please contact support.';
                    }
                } else {
                    errorMessage.textContent = 'Incorrect password. Please try again.';
                    passwordInput.value = '';
                }
            }
            
            function unlockApp() {
                passwordOverlay.style.display = 'none';
                mainContent.classList.add('unlocked');
                
                // If API key isn't decrypted yet, decrypt it
                if (!decryptedApiKey) {
                    try {
                        const bytes = CryptoJS.AES.decrypt(ENCRYPTED_API_KEY, CORRECT_PASSWORD);
                        decryptedApiKey = bytes.toString(CryptoJS.enc.Utf8);
                    } catch (error) {
                        console.error('Error decrypting API key:', error);
                    }
                }
                
                // Initialize the main app
                initializeApp();
            }
        });
        
        // Main application functionality
        function initializeApp() {
            const originalCopyInput = document.getElementById('original-copy');
            const numVariationsSelect = document.getElementById('num-variations');
            const copyFormatSelect = document.getElementById('copy-format');
            const platformSelect = document.getElementById('platform');
            const leadTypeSelect = document.getElementById('lead-type');
            const copywritingStyleSelect = document.getElementById('copywriting-style');
            const famousCopywriterSelect = document.getElementById('famous-copywriter');
            const emotionalTriggerSelect = document.getElementById('emotional-trigger');
            const anglesSelect = document.getElementById('angles');
            const aggressivenessSlider = document.getElementById('aggressiveness');
            const aggressivenessValue = document.getElementById('aggressiveness-value');
            const researchDataInput = document.getElementById('research-data');
            const generateBtn = document.getElementById('generate-btn');
            const regenerateBtn = document.getElementById('regenerate-btn');
            const copyAllBtn = document.getElementById('copy-all-btn');
            const outputContainer = document.getElementById('output-container');
            const loader = document.getElementById('loader');
            
            // History elements
            const historyToggle = document.getElementById('history-toggle');
            const historyPanel = document.getElementById('history-panel');
            const closeHistory = document.getElementById('close-history');
            const clearHistory = document.getElementById('clear-history');
            const historyContent = document.getElementById('history-content');
            const selectWinnerBtn = document.getElementById('select-winner-btn');
            const downloadHistoryBtn = document.getElementById('download-history');
            
            // Initialize history
            updateHistoryDisplay();
            updateHistoryStats();
            
            // History event listeners
            historyToggle.addEventListener('click', () => {
                historyPanel.classList.add('open');
            });
            
            closeHistory.addEventListener('click', () => {
                historyPanel.classList.remove('open');
            });
            
            clearHistory.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear all copy history? This cannot be undone.')) {
                    copyHistory = [];
                    localStorage.setItem('copyHistory', JSON.stringify(copyHistory));
                    updateHistoryDisplay();
                    updateHistoryStats();
                }
            });
            
            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    updateHistoryDisplay();
                });
            });
            
            // Update aggressiveness value display
            aggressivenessSlider.addEventListener('input', (e) => {
                aggressivenessValue.textContent = e.target.value;
            });
            
            generateBtn.addEventListener('click', generateVariations);
            regenerateBtn.addEventListener('click', generateVariations);
            copyAllBtn.addEventListener('click', copyAllVariations);
            
            // Event delegation for copy buttons
            outputContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('copy-button')) {
                    const variationText = e.target.closest('.variation').querySelector('p').textContent;
                    navigator.clipboard.writeText(variationText);
                    
                    const originalText = e.target.textContent;
                    e.target.textContent = 'Copied!';
                    setTimeout(() => {
                        e.target.textContent = originalText;
                    }, 2000);
                }
                
                // Click on variation to select it
                const variation = e.target.closest('.variation');
                if (variation && !e.target.classList.contains('copy-button')) {
                    // Remove previous selection
                    outputContainer.querySelectorAll('.variation').forEach((v, index) => {
                        v.classList.remove('selected-winner');
                        const badge = v.querySelector('.winner-badge');
                        if (badge) badge.remove();
                    });
                    
                    // Add selection to clicked variation
                    variation.classList.add('selected-winner');
                    const badge = document.createElement('div');
                    badge.className = 'winner-badge';
                    badge.textContent = '✓ Selected';
                    variation.appendChild(badge);
                    
                    // Store selected index
                    selectedVariationIndex = Array.from(outputContainer.querySelectorAll('.variation')).indexOf(variation);
                    
                    // Show select winner button
                    selectWinnerBtn.style.display = 'block';
                }
            });
            
            // Download history functionality
            downloadHistoryBtn.addEventListener('click', downloadHistoryToExcel);
            
            // Select winner functionality
            selectWinnerBtn.addEventListener('click', () => {
                if (selectedVariationIndex !== null && currentVariations.length > 0) {
                    // Save winner to history
                    saveWinnerToHistory();
                    
                    // Visual feedback
                    selectWinnerBtn.textContent = 'Winner Selected!';
                    selectWinnerBtn.disabled = true;
                    setTimeout(() => {
                        selectWinnerBtn.textContent = 'Select Winner';
                        selectWinnerBtn.disabled = false;
                        selectWinnerBtn.style.display = 'none';
                    }, 2000);
                }
            });
            
            async function generateVariations() {
                const originalCopy = originalCopyInput.value.trim();
                const numVariations = parseInt(numVariationsSelect.value);
                const copyFormat = copyFormatSelect.value;
                const platform = platformSelect.value;
                const leadType = leadTypeSelect.value;
                const copywritingStyle = copywritingStyleSelect.value;
                const famousCopywriter = famousCopywriterSelect.value;
                const emotionalTrigger = emotionalTriggerSelect.value;
                const angles = anglesSelect.value;
                const aggressiveness = parseInt(aggressivenessSlider.value);
                const researchData = researchDataInput.value.trim();
                
                // Validate inputs
                if (!decryptedApiKey) {
                    alert('API key not available. Please logout and login again.');
                    return;
                }
                
                if (!originalCopy) {
                    alert('Please enter your original copy');
                    return;
                }
                
                // Show loader
                loader.style.display = 'block';
                outputContainer.querySelectorAll('.variation').forEach(el => el.remove());
                generateBtn.disabled = true;
                
                // Reset selection
                selectedVariationIndex = null;
                selectWinnerBtn.style.display = 'none';
                
                try {
                    const variations = await fetchVariationsFromAPI(decryptedApiKey, originalCopy, numVariations, copyFormat, platform, leadType, copywritingStyle, emotionalTrigger, angles, aggressiveness, researchData, famousCopywriter);
                    
                    // Store current variations and settings
                    currentVariations = variations;
                    currentSettings = {
                        originalCopy,
                        variations,
                        settings: {
                            copyFormat,
                            platform,
                            leadType,
                            copywritingStyle,
                            famousCopywriter,
                            emotionalTrigger,
                            angles,
                            aggressiveness,
                            researchData,
                            numVariations
                        }
                    };
                    
                    displayVariations(variations);
                    regenerateBtn.style.display = 'block';
                    
                    // Save to history
                    saveToHistory(currentSettings);
                    
                } catch (error) {
                    alert(`Error: ${error.message}`);
                    console.error('Error generating variations:', error);
                } finally {
                    loader.style.display = 'none';
                    generateBtn.disabled = false;
                }
            }
            
            function saveToHistory(session) {
                const historyItem = {
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    originalCopy: session.originalCopy,
                    variations: session.variations,
                    settings: session.settings,
                    tag: 'neutral' // neutral, winner, loser
                };
                
                copyHistory.unshift(historyItem); // Add to beginning
                
                localStorage.setItem('copyHistory', JSON.stringify(copyHistory));
                updateHistoryDisplay();
                updateHistoryStats();
            }
            
            function updateHistoryDisplay() {
                const filteredHistory = copyHistory.filter(item => {
                    if (currentFilter === 'all') return true;
                    if (currentFilter === 'winners') return item.tag === 'winner';
                    if (currentFilter === 'losers') return item.tag === 'loser';
                    return true;
                });
                
                if (filteredHistory.length === 0) {
                    historyContent.innerHTML = '<div class="no-history">No items match the current filter.</div>';
                    return;
                }
                
                historyContent.innerHTML = filteredHistory.map(item => {
                    const date = new Date(item.timestamp);
                    const timeAgo = getTimeAgo(date);
                    
                    const settingsText = [
                        item.settings.copyFormat && `Format: ${item.settings.copyFormat}`,
                        item.settings.platform && `Platform: ${item.settings.platform}`,
                        item.settings.leadType && `Lead: ${item.settings.leadType}`,
                        item.settings.copywritingStyle && `Style: ${item.settings.copywritingStyle}`,
                        item.settings.aggressiveness && `Aggressiveness: ${item.settings.aggressiveness}/10`
                    ].filter(Boolean).join(' • ');
                    
                    const winnerInfo = item.winnerIndex !== undefined && item.winnerText ? 
                        `<div style="background-color: #f0fdf4; padding: 8px; margin: 8px 0; border-radius: 4px; border-left: 3px solid #10b981;">
                            <strong style="color: #10b981;">✓ Winner (Variation ${item.winnerIndex + 1}):</strong> ${item.winnerText.substring(0, 150)}${item.winnerText.length > 150 ? '...' : ''}
                        </div>` : '';
                    
                    return `
                        <div class="history-item ${item.tag}" data-id="${item.id}">
                            <div class="history-meta">
                                <span>${timeAgo}</span>
                                <span>${item.variations.length} variations</span>
                            </div>
                            ${settingsText ? `<div class="history-settings">${settingsText}</div>` : ''}
                            <div class="history-original">Original: "${item.originalCopy.substring(0, 100)}${item.originalCopy.length > 100 ? '...' : ''}"</div>
                            ${winnerInfo}
                            <div class="history-variations">
                                ${item.variations.map((variation, index) => {
                                    const isWinner = item.winnerIndex === index;
                                    const isLoser = item.winnerIndex !== undefined && !isWinner;
                                    return `
                                        <div class="history-variation" style="${isWinner ? 'background-color: #f0fdf4; border-color: #10b981;' : isLoser ? 'background-color: #fef2f2; border-color: #ef4444;' : ''}">
                                            <strong>Variation ${index + 1}${isWinner ? ' ✓' : isLoser ? ' ✗' : ''}:</strong> ${variation.substring(0, 150)}${variation.length > 150 ? '...' : ''}
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                            <div class="history-actions">
                                <button class="tag-btn ${item.tag === 'winner' ? 'tag-winner' : 'tag-neutral'}" onclick="tagHistoryItem(${item.id}, 'winner')">
                                    ${item.tag === 'winner' ? '✓ Winner' : 'Tag Winner'}
                                </button>
                                <button class="tag-btn ${item.tag === 'loser' ? 'tag-loser' : 'tag-neutral'}" onclick="tagHistoryItem(${item.id}, 'loser')">
                                    ${item.tag === 'loser' ? '✗ Loser' : 'Tag Loser'}
                                </button>
                                <button class="tag-btn copy-history-btn" onclick="copyHistoryItem(${item.id})">Copy All</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            function updateHistoryStats() {
                const totalSessions = copyHistory.length;
                const totalWinners = copyHistory.filter(item => item.tag === 'winner').length;
                const totalLosers = copyHistory.filter(item => item.tag === 'loser').length;
                
                document.getElementById('total-sessions').textContent = totalSessions;
                document.getElementById('total-winners').textContent = totalWinners;
                document.getElementById('total-losers').textContent = totalLosers;
            }
            
            function getTimeAgo(date) {
                const now = new Date();
                const diffInSeconds = Math.floor((now - date) / 1000);
                
                if (diffInSeconds < 60) return 'Just now';
                if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m ago`;
                if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h ago`;
                return `${Math.floor(diffInSeconds / 86400)}d ago`;
            }
            
            // Make functions globally accessible
            window.tagHistoryItem = function(id, tag) {
                const item = copyHistory.find(item => item.id === id);
                if (item) {
                    item.tag = item.tag === tag ? 'neutral' : tag;
                    localStorage.setItem('copyHistory', JSON.stringify(copyHistory));
                    updateHistoryDisplay();
                    updateHistoryStats();
                }
            };
            
            window.copyHistoryItem = function(id) {
                const item = copyHistory.find(item => item.id === id);
                if (item) {
                    const allText = `Original Copy:\n${item.originalCopy}\n\nVariations:\n${item.variations.map((v, i) => `${i + 1}. ${v}`).join('\n\n')}`;
                    navigator.clipboard.writeText(allText);
                    
                    // Visual feedback
                    const btn = event.target;
                    const originalText = btn.textContent;
                    btn.textContent = 'Copied!';
                    setTimeout(() => {
                        btn.textContent = originalText;
                    }, 2000);
                }
            };
            
            function saveWinnerToHistory() {
                if (selectedVariationIndex === null || !currentSettings) return;
                
                const historyItem = {
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    originalCopy: currentSettings.originalCopy,
                    variations: currentSettings.variations,
                    settings: currentSettings.settings,
                    tag: 'winner',
                    winnerIndex: selectedVariationIndex,
                    winnerText: currentVariations[selectedVariationIndex]
                };
                
                copyHistory.unshift(historyItem);
                
                localStorage.setItem('copyHistory', JSON.stringify(copyHistory));
                updateHistoryDisplay();
                updateHistoryStats();
            }
            
            function downloadHistoryToExcel() {
                if (copyHistory.length === 0) {
                    alert('No history to download');
                    return;
                }
                
                // Create CSV content
                let csvContent = 'Date,Time,Status,Original Copy,Winner Variation,All Variations,Format,Platform,Lead Type,Style,Copywriter,Emotional Trigger,Angle,Aggressiveness,Research Data\n';
                
                copyHistory.forEach(item => {
                    const date = new Date(item.timestamp);
                    const dateStr = date.toLocaleDateString();
                    const timeStr = date.toLocaleTimeString();
                    const status = item.tag;
                    const originalCopy = `"${item.originalCopy.replace(/"/g, '""')}"`;
                    const winnerVariation = item.winnerIndex !== undefined && item.winnerText ? 
                        `"${item.winnerText.replace(/"/g, '""')}"` : 
                        (item.tag === 'winner' ? `"${item.variations[0].replace(/"/g, '""')}"` : '');
                    const allVariations = `"${item.variations.map((v, i) => `Variation ${i + 1}: ${v}`).join('\n\n').replace(/"/g, '""')}"`;
                    
                    const settings = item.settings || {};
                    const format = settings.copyFormat || '';
                    const platform = settings.platform || '';
                    const leadType = settings.leadType || '';
                    const style = settings.copywritingStyle || '';
                    const copywriter = settings.famousCopywriter || '';
                    const emotionalTrigger = settings.emotionalTrigger || '';
                    const angle = settings.angles || '';
                    const aggressiveness = settings.aggressiveness || '';
                    const researchData = settings.researchData ? `"${settings.researchData.replace(/"/g, '""')}"` : '';
                    
                    csvContent += `${dateStr},${timeStr},${status},${originalCopy},${winnerVariation},${allVariations},${format},${platform},${leadType},${style},${copywriter},${emotionalTrigger},${angle},${aggressiveness},${researchData}\n`;
                });
                
                // Create blob and download
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                link.setAttribute('href', url);
                link.setAttribute('download', `copywriting_history_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
            
            async function fetchVariationsFromAPI(apiKey, originalCopy, numVariations, copyFormat, platform, leadType, copywritingStyle, emotionalTrigger, angles, aggressiveness, researchData, famousCopywriter) {
                // Define copy format descriptions
                const formatDescriptions = {
                    'ad-script': 'Ad Script - Write a complete advertisement script for video or audio ads. Include spoken dialogue, timing cues, and call-to-action. Structure with opening hook, main message, benefits, and strong close.',
                    'video-hook': 'Video Hook - Create compelling opening lines for video advertisements that grab attention in the first 3-5 seconds. Focus on curiosity, shock value, or immediate benefit to stop scrolling.',
                    'ad-copy-headline': 'Ad Copy Headline - Write powerful, attention-grabbing headlines for advertisements. Should be concise, benefit-driven, and compelling enough to make people want to read more.',
                    'ad-copy-text': 'Ad Copy Ad Text - Create the main body text for advertisements. Include benefits, features, social proof, and clear call-to-action. Should be persuasive and conversion-focused.',
                    'lander-headline': 'Landing Page Headline - Write compelling headlines for landing pages that immediately communicate value proposition and encourage visitors to stay and convert.'
                };

                // Define platform-specific requirements
                const platformRequirements = {
                    'google': {
                        'ad-script': 'Google Ads Script: Keep under 30 seconds for YouTube ads. Include clear value proposition and strong CTA.',
                        'video-hook': 'Google Video Hook: Optimize for YouTube - grab attention immediately, mention key benefit within first 5 seconds.',
                        'ad-copy-headline': 'Google Ads Headline: Character limit 30 chars per headline. Create 3 headlines that work together. Focus on keywords and benefits.',
                        'ad-copy-text': 'Google Ads Description: 90 character limit per description line. Create 2 description lines. Include call-to-action and key benefits.',
                        'lander-headline': 'Google Landing Page Headline: Optimize for Quality Score. Match ad copy messaging. Include primary keywords naturally.'
                    },
                    'facebook': {
                        'ad-script': 'Facebook Ads Script: Optimize for mobile viewing. Hook within first 3 seconds. Include captions-friendly dialogue.',
                        'video-hook': 'Facebook Video Hook: Mobile-first approach. Visual storytelling. Pattern interrupt to stop scroll.',
                        'ad-copy-headline': 'Facebook Ads Headline: 40 character limit. Emotional appeal. Benefit-focused. Works with visual creative.',
                        'ad-copy-text': 'Facebook Ad Text: 125 characters for optimal performance. Conversational tone. Include emoji strategically. Clear CTA.',
                        'lander-headline': 'Facebook Landing Page Headline: Match ad messaging. Mobile-optimized. Emotional connection with audience.'
                    }
                };

                // Define copywriting style descriptions
                const styleDescriptions = {
                    'direct-response': 'Direct Response Style - Write with clear calls-to-action, immediate benefits, and measurable outcomes. Use action-oriented language, specific numbers, and create urgency for immediate response.',
                    'emotional': 'Emotional Style - Appeal to feelings, desires, fears, and aspirations. Use sensory language, personal stories, and emotional triggers to create deep connection with the reader.',
                    'conversational': 'Conversational Style - Write as if speaking directly to a friend. Use casual language, contractions, questions, and a warm, approachable tone that feels personal and relatable.',
                    'authoritative': 'Authoritative Style - Establish expertise and credibility. Use confident language, industry knowledge, statistics, and professional tone to position as a trusted authority.',
                    'urgency': 'Urgency & Scarcity Style - Create immediate action through time-sensitive offers, limited availability, and fear of missing out. Use countdown language and exclusive opportunities.',
                    'benefit-focused': 'Benefit-Focused Style - Emphasize what the customer gains rather than product features. Focus on outcomes, results, and positive changes in the customer\'s life.',
                    'storytelling': 'Storytelling Style - Use narrative structure with beginning, middle, and end. Include characters, conflict, and resolution to make the message memorable and engaging.',
                    'social-proof': 'Social Proof Style - Leverage testimonials, reviews, case studies, and popularity indicators. Show that others have succeeded or chosen this option to build trust and credibility.',
                    'curiosity': 'Curiosity-Driven Style - Create intrigue and mystery that compels readers to learn more. Use incomplete information, surprising facts, and questions that demand answers.',
                    'fear-based': 'Fear-Based Style - Address potential negative consequences of inaction. Highlight problems, risks, and what could be lost if the reader doesn\'t take action.',
                    'aspirational': 'Aspirational Style - Paint a picture of an ideal future state. Focus on dreams, goals, and the elevated lifestyle or status the product/service can provide.',
                    'educational': 'Educational Style - Inform and teach while selling. Provide valuable information, explain concepts, and position the product/service as the logical solution based on the education provided.'
                };

                // Define lead type descriptions based on George Felton's "Advertising: Concept and Copy"
                const leadDescriptions = {
                    'story': 'Story Lead - Start with a narrative, anecdote, or scenario that draws readers in emotionally before connecting to the product/service. Use storytelling elements like characters, conflict, and resolution.',
                    'proclamation': 'Proclamation Lead - Make a bold, confident statement or declaration about the product/service. Be direct, authoritative, and attention-grabbing with strong, declarative language.',
                    'secret': 'Secret Lead - Reveal insider information, hidden knowledge, or exclusive insights. Use phrases like "What they don\'t want you to know" or "The secret that..." to create curiosity and urgency.',
                    'problem-solution': 'Problem-Solution Lead - Identify a specific problem your audience faces, then present your product/service as the solution. Start with the pain point before introducing the remedy.',
                    'promise': 'Promise Lead - Make a compelling promise about what the product/service will deliver. Focus on benefits and outcomes, using confident language about what the customer will achieve or receive.',
                    'offer': 'Offer Lead - Lead with a specific deal, discount, bonus, or limited-time offer. Make the value proposition immediately clear and create urgency around the offer.'
                };

                // Define benefit contexts for different angles
                const benefitContexts = {
                    'otc-cards': 'Focus on Over-the-Counter (OTC) benefits and cards that help cover everyday health items like vitamins, pain relievers, and health products.',
                    'flex-cards': 'Emphasize flexible spending benefits and cards that can be used for various health-related expenses and services.',
                    'cashback': 'Highlight Part B premium giveback benefits and cashback opportunities that put money back in Medicare beneficiaries\' pockets.',
                    'dental': 'Focus on dental coverage benefits, including cleanings, fillings, and other dental care that traditional Medicare doesn\'t cover.',
                    'vision': 'Emphasize vision benefits including eye exams, glasses, contacts, and other vision care services.',
                    'hearing': 'Highlight hearing aid benefits and hearing care services that help Medicare beneficiaries with hearing health.',
                    'groceries': 'Focus on grocery benefits and allowances that help Medicare beneficiaries save money on food and household essentials.',
                    'gas-money': 'Emphasize transportation benefits and gas allowances that help Medicare beneficiaries with travel and mobility costs.',
                    'savings': 'Focus on overall savings opportunities and cost reductions available through Medicare Advantage plans.',
                    'auto-insurance': 'Focus on auto insurance benefits, competitive rates, coverage options, and savings opportunities for drivers.',
                    'auto-coverage': 'Emphasize comprehensive auto coverage, protection benefits, and peace of mind for vehicle owners.',
                    'auto-rates': 'Highlight competitive auto insurance rates, cost savings, and affordable premium options.',
                    'final-expense-burial': 'Focus on burial insurance and final expense coverage that helps families cover funeral costs and end-of-life expenses.',
                    'final-expense-life': 'Emphasize life insurance for final expenses, providing financial protection and peace of mind for loved ones.',
                    'final-expense-coverage': 'Highlight comprehensive final expense coverage that ensures dignity and reduces financial burden on families.',
                    'dollar-50': 'Focus on the $50 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-100': 'Focus on the $100 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-150': 'Focus on the $150 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-200': 'Focus on the $200 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-250': 'Focus on the $250 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-300': 'Focus on the $300 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-400': 'Focus on the $400 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-500': 'Focus on the $500 dollar amount - emphasize this specific value as savings, benefits, cashback, or monthly amounts. Make this dollar figure prominent and compelling.',
                    'dollar-1000': 'Focus on the $1,000 dollar amount - emphasize this specific value as savings, benefits, cashback, or annual amounts. Make this dollar figure prominent and compelling.',
                    'dollar-1500': 'Focus on the $1,500 dollar amount - emphasize this specific value as savings, benefits, cashback, or annual amounts. Make this dollar figure prominent and compelling.',
                    'dollar-2000': 'Focus on the $2,000 dollar amount - emphasize this specific value as savings, benefits, cashback, or annual amounts. Make this dollar figure prominent and compelling.'
                };

                // Define emotional trigger descriptions
                const emotionalTriggerDescriptions = {
                    'fear-of-missing-out': 'Fear of Missing Out (FOMO) - Create urgency by highlighting limited-time opportunities, exclusive access, or what others are already enjoying. Use phrases like "Don\'t miss out," "Limited time," "Others are already..."',
                    'security-safety': 'Security & Safety - Appeal to the need for protection, stability, and peace of mind. Focus on reducing risks, providing guarantees, and ensuring safety for family and future.',
                    'pride-status': 'Pride & Status - Appeal to the desire for recognition, prestige, and social standing. Highlight exclusivity, premium quality, and how this elevates their position or image.',
                    'love-belonging': 'Love & Belonging - Connect to family values, community, and relationships. Focus on caring for loved ones, being part of a group, and social connections.',
                    'anger-frustration': 'Anger & Frustration - Address pain points, injustices, or problems that make people angry. Channel frustration into action by positioning your solution as the answer.',
                    'hope-optimism': 'Hope & Optimism - Inspire positive emotions about the future. Paint a picture of better days ahead, dreams coming true, and positive transformation.',
                    'guilt-shame': 'Guilt & Shame - Carefully address feelings of not doing enough or missing responsibilities. Focus on redemption and making things right (use sensitively).',
                    'excitement-joy': 'Excitement & Joy - Create enthusiasm and positive anticipation. Use energetic language, celebrate benefits, and make the experience feel fun and rewarding.',
                    'trust-credibility': 'Trust & Credibility - Build confidence through testimonials, credentials, guarantees, and proof. Address skepticism and establish reliability.',
                    'curiosity-intrigue': 'Curiosity & Intrigue - Create mystery and desire to learn more. Use incomplete information, surprising facts, and questions that demand answers.',
                    'urgency-scarcity': 'Urgency & Scarcity - Create immediate action through time limits, limited quantities, or exclusive availability. Emphasize "act now" messaging.',
                    'empowerment-control': 'Empowerment & Control - Appeal to the desire for independence, choice, and taking charge of one\'s situation. Focus on putting power back in their hands.'
                };

                // Define famous copywriter styles from George Felton's "Advertising: Concept and Copy"
                const famousCopywriterStyles = {
                    'david-ogilvy': 'David Ogilvy Style - "The Father of Advertising." Use factual, research-based copy with long headlines, detailed body text, and sophisticated language. Focus on brand image, consumer benefits, and elegant persuasion.',
                    'bill-bernbach': 'Bill Bernbach Style - Creative revolution pioneer. Use wit, humor, and unexpected angles. Combine art and copy seamlessly. Challenge conventions with clever, memorable messaging that breaks through clutter.',
                    'leo-burnett': 'Leo Burnett Style - "Chicago School" approach. Use warm, human, down-to-earth language. Create inherent drama and emotional connection. Focus on simple truths and authentic brand personalities.',
                    'rosser-reeves': 'Rosser Reeves Style - "Unique Selling Proposition" creator. Use hard-hitting, repetitive messaging. Focus on one clear benefit and hammer it home. Direct, no-nonsense approach with measurable claims.',
                    'claude-hopkins': 'Claude Hopkins Style - Scientific advertising pioneer. Use tested, measurable copy with specific claims and proof. Focus on reason-why advertising and direct response principles.',
                    'john-caples': 'John Caples Style - Direct mail master. Use curiosity-driven headlines, benefit-focused copy, and strong calls-to-action. Test everything and focus on what gets results.',
                    'eugene-schwartz': 'Eugene Schwartz Style - "Breakthrough Advertising" author. Use sophisticated psychology, market awareness levels, and desire intensification. Focus on tapping into existing desires rather than creating new ones.',
                    'gary-halbert': 'Gary Halbert Style - "The Prince of Print." Use conversational, personal tone with storytelling elements. Focus on emotional connection, credibility building, and irresistible offers.',
                    'dan-kennedy': 'Dan Kennedy Style - No B.S. direct response approach. Use bold, controversial statements and strong personality. Focus on immediate action, scarcity, and high-value propositions.',
                    'joe-sugarman': 'Joe Sugarman Style - "The Adweek Copywriting Handbook" author. Use psychological triggers, smooth flow, and compelling storytelling. Focus on overcoming objections and creating buying momentum.',
                    'victor-schwab': 'Victor Schwab Style - "How to Write a Good Advertisement" author. Use systematic approach with attention-getting headlines, interest-building copy, and desire creation.',
                    'robert-collier': 'Robert Collier Style - "The Robert Collier Letter Book" author. Use personal, letter-like approach with emotional appeals and detailed explanations. Focus on building relationships through copy.',
                    'maxwell-sackheim': 'Maxwell Sackheim Style - Book club advertising pioneer. Use intellectual appeal, curiosity, and educational benefits. Focus on making complex offers simple and appealing.',
                    'john-e-kennedy': 'John E. Kennedy Style - "Salesmanship in print" pioneer. Use reason-why advertising with logical arguments and proof. Focus on clear benefits and rational persuasion.',
                    'albert-lasker': 'Albert Lasker Style - "Father of Modern Advertising." Use dramatic, attention-getting copy with strong emotional appeals. Focus on creating desire and memorable brand impressions.'
                };
                
                const formatDescription = formatDescriptions[copyFormat] || formatDescriptions['ad-copy-text'];
                const platformRequirement = platformRequirements[platform] ? platformRequirements[platform][copyFormat] || '' : '';
                const leadDescription = leadDescriptions[leadType] || leadDescriptions['story'];
                const styleDescription = styleDescriptions[copywritingStyle] || styleDescriptions['direct-response'];
                const famousCopywriterStyle = famousCopywriter ? famousCopywriterStyles[famousCopywriter] : '';
                const emotionalTriggerDescription = emotionalTrigger ? emotionalTriggerDescriptions[emotionalTrigger] : '';
                const angleContext = angles ? benefitContexts[angles] : '';
                
                // Define aggressiveness levels
                const aggressivenessLevels = {
                    1: 'Very Subtle - Gentle suggestions, soft language, minimal pressure',
                    2: 'Subtle - Polite recommendations, understated benefits',
                    3: 'Mild - Clear benefits, some persuasive language',
                    4: 'Moderate - Confident claims, moderate urgency',
                    5: 'Balanced - Strong benefits, balanced persuasion',
                    6: 'Assertive - Bold claims, clear calls-to-action',
                    7: 'Strong - Powerful language, strong urgency',
                    8: 'Aggressive - Intense pressure, strong emotional appeals',
                    9: 'Very Aggressive - High-pressure tactics, dramatic language',
                    10: 'Maximum Aggressive - Extreme urgency, maximum emotional intensity'
                };
                
                const aggressivenessDescription = aggressivenessLevels[aggressiveness] || aggressivenessLevels[5];
                
                let systemPrompt = `You are a professional copywriter expert in creating ${copyFormat.replace('-', ' ')} for ${platform === 'google' ? 'Google Ads' : platform === 'facebook' ? 'Facebook Ads' : 'advertising'}.

COPY FORMAT: ${formatDescription}

${platformRequirement ? `PLATFORM REQUIREMENTS: ${platformRequirement}` : ''}

LEAD TYPE: ${leadDescription}

COPYWRITING STYLE: ${styleDescription}

AGGRESSIVENESS LEVEL (${aggressiveness}/10): ${aggressivenessDescription}

IMPORTANT: Combine the copy format requirements, platform specifications, lead type approach, copywriting style, AND aggressiveness level. The copy format determines the structure and purpose, the platform requirements determine technical constraints and optimization, the lead type determines how you start and structure the copy, the copywriting style determines the overall tone and persuasion approach, and the aggressiveness level determines the intensity and pressure of the language.`;

                if (famousCopywriterStyle) {
                    systemPrompt += `

FAMOUS COPYWRITER STYLE: ${famousCopywriterStyle}
Emulate this legendary copywriter's distinctive approach, techniques, and voice while adapting to the modern platform requirements.`;
                }

                if (emotionalTriggerDescription) {
                    systemPrompt += `

EMOTIONAL TRIGGER: ${emotionalTriggerDescription}
Incorporate this specific emotional trigger throughout the copy to create the desired emotional response and connection with the audience.`;
                }

                if (angleContext) {
                    systemPrompt += `

ANGLE FOCUS: ${angleContext}
When writing variations, incorporate this angle context naturally into the copy while maintaining the copy format, platform requirements, lead type, and copywriting style.`;
                }

                if (researchData) {
                    systemPrompt += `

RESEARCH DATA TO INCORPORATE: ${researchData}
Use this research data, statistics, studies, or facts naturally within the copy variations. Integrate these data points to support claims, add credibility, and strengthen the persuasive impact. Present the data in a compelling way that supports the overall message.`;
                }

                systemPrompt += `

Generate ${numVariations} different variations of the provided copy following the specified copy format${platform ? ` for ${platform === 'google' ? 'Google Ads' : 'Facebook Ads'}` : ''}. Each variation should:
1. Follow the copy format's specific structure and purpose
${platformRequirement ? '2. Meet the platform\'s technical requirements and constraints' : ''}
${platformRequirement ? '3. Start with the lead type\'s specific approach (how you open and structure the copy)' : '2. Start with the lead type\'s specific approach (how you open and structure the copy)'}
${platformRequirement ? '4. Apply the copywriting style throughout (tone, language, and persuasion techniques)' : '3. Apply the copywriting style throughout (tone, language, and persuasion techniques)'}
${platformRequirement ? '5. Match the aggressiveness level (intensity and pressure of language)' : '4. Match the aggressiveness level (intensity and pressure of language)'}
${platformRequirement ? '6. Maintain the core message and value proposition' : '5. Maintain the core message and value proposition'}
${platformRequirement ? '7. Use unique wording and approach for each variation' : '6. Use unique wording and approach for each variation'}
${platformRequirement ? '8. Be optimized for the specific platform\'s audience and format' : '7. Be optimized for the target audience'}
${platformRequirement ? '9. Number each variation clearly (1., 2., 3., etc.)' : '8. Number each variation clearly (1., 2., 3., etc.)'}`;

                let instructionNumber = platformRequirement ? 10 : 9;
                if (famousCopywriterStyle) {
                    systemPrompt += `
${instructionNumber}. Emulate the famous copywriter's distinctive style and techniques`;
                    instructionNumber++;
                }

                if (emotionalTriggerDescription) {
                    systemPrompt += `
${instructionNumber}. Incorporate the emotional trigger to create the desired emotional response`;
                    instructionNumber++;
                }

                if (angleContext) {
                    systemPrompt += `
${instructionNumber}. Naturally incorporate the angle focus when relevant`;
                    instructionNumber++;
                }

                if (researchData) {
                    systemPrompt += `
${instructionNumber}. Integrate the provided research data to support claims and add credibility`;
                }

                systemPrompt += `

Focus on making each variation distinctly different while staying true to the copy format requirements${platformRequirement ? ', platform specifications' : ''}, lead type's opening approach, copywriting style, ${famousCopywriterStyle ? 'famous copywriter techniques, ' : ''}${emotionalTriggerDescription ? 'emotional trigger, ' : ''}and aggressiveness level. All elements should work together seamlessly for maximum${platform ? ` ${platform === 'google' ? 'Google Ads' : 'Facebook Ads'}` : ''} performance.`;
                
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [
                            {
                                role: 'system',
                                content: systemPrompt
                            },
                            {
                                role: 'user',
                                content: `Original copy: ${originalCopy}`
                            }
                        ],
                        temperature: 0.8,
                        max_tokens: 2000
                    })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error.message || 'Failed to generate variations');
                }
                
                const data = await response.json();
                const content = data.choices[0].message.content;
                
                // Parse the response to get individual variations
                return parseVariations(content, numVariations);
            }
            
            function parseVariations(content, expectedCount) {
                // Split by numbered variations (1., 2., etc.)
                const regex = /\d+\.\s+/;
                const parts = content.split(regex).filter(part => part.trim() !== '');
                
                // If parsing failed, return the whole content as one variation
                if (parts.length < expectedCount) {
                    // Try another approach with line breaks
                    const lineBreakParts = content.split('\n\n').filter(part => part.trim() !== '');
                    if (lineBreakParts.length >= expectedCount) {
                        return lineBreakParts.slice(0, expectedCount);
                    }
                    
                    // If all parsing attempts fail, just split the content roughly equally
                    return [content];
                }
                
                return parts.slice(0, expectedCount);
            }
            
            function displayVariations(variations) {
                outputContainer.innerHTML = '';
                
                variations.forEach((variation, index) => {
                    const variationDiv = document.createElement('div');
                    variationDiv.className = 'variation';
                    
                    const variationNumber = document.createElement('div');
                    variationNumber.className = 'variation-number';
                    variationNumber.textContent = `Variation ${index + 1}`;
                    
                    const copyButton = document.createElement('button');
                    copyButton.className = 'copy-button';
                    copyButton.textContent = 'Copy';
                    
                    const content = document.createElement('p');
                    content.textContent = variation.trim();
                    
                    variationDiv.appendChild(variationNumber);
                    variationDiv.appendChild(copyButton);
                    variationDiv.appendChild(content);
                    
                    outputContainer.appendChild(variationDiv);
                });
            }
            
            function copyAllVariations() {
                const allVariations = Array.from(outputContainer.querySelectorAll('.variation p'))
                    .map((el, index) => `Variation ${index + 1}:\n${el.textContent}\n\n`)
                    .join('');
                
                if (allVariations) {
                    navigator.clipboard.writeText(allVariations);
                    copyAllBtn.textContent = 'All Copied!';
                    setTimeout(() => {
                        copyAllBtn.textContent = 'Copy All';
                    }, 2000);
                }
            }
        }
    </script>
</body>
</html> 